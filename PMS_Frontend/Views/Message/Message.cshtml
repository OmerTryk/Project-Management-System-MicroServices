@using PMS_Frontend.Models.ViewModels.MessageVM
@model MessagePageVM
@{
    ViewData["Title"] = "Message";
    Layout = "~/Views/Shared/_Layout1.cshtml";
}

<h2>Mesajlaşma</h2>

<form asp-controller="Message" asp-action="SendMessage" method="post">
    <div class="form-group">
        <label>Alıcının Nickname'i:</label>
        <input asp-for="NewMessage.ReceiverNickName" class="form-control" placeholder="Alıcının Nickname'ini girin" required />
    </div>

    <div class="form-group mt-2">
        <label for="Content">Mesaj:</label>
        <textarea asp-for="NewMessage.Content" class="form-control" placeholder="Mesajınızı yazın..." rows="3" required></textarea>
    </div>

    <button type="submit" class="btn btn-primary mt-3">Gönder</button>
</form>

<hr />

<h4 class="mt-4">Mesaj Geçmişi</h4>
@if (Model.PreviousMessages != null && Model.PreviousMessages.Any())
{
    <div style="max-height: 300px; overflow-y: auto; border: 1px solid #ccc; padding: 10px;">
        @foreach (var msg in Model.PreviousMessages)
        {
            <div style="margin-bottom: 10px;">
                <strong>@msg.SenderNickName:</strong>
                <p>@msg.Content</p>
                <small class="text-muted">
                    @(msg.Timestamp.HasValue ? msg.Timestamp.Value.ToString("g") : "Tarih yok")
                </small>
                <hr />
            </div>
        }
    </div>
}
else
{
    <p>Henüz mesaj yok.</p>
}

